---
- name: copy diruse
  hosts: windows
  gather_facts: false
  tasks:
    - name: Create Desktop Info folder
      win_file:
        path: 'C:\Program Files (x86)\DesktopInfo'
        state: directory
    - name: Stop Desktop Info Process if runs
      win_shell: |
        try{
        $desktopInfo = Get-Process desktopinfo -ErrorAction stop
        if ($desktopInfo) {
            $canStop = $True
            Stop-Process -Force -ErrorAction SilentlyContinue
        }
        }
        catch{
          $canStop = $False
        }
        if ($canStop) {
            Get-Process desktopinfo | Stop-Process -Force
            return 0
        }
        else
        {
          return 0
        }
